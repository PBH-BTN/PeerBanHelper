import{u as E,b as R,c as G,I as U,f as I,h as ne,_ as M,j as me}from"./index-B35Mpysw.js";/* empty css              */import{f as q,a7 as O,a8 as oe,w as j,s as p,a3 as e,k as r,t,y as a,v as o,x as s,m as N,u as g,j as V,P as le,F as se,c as ie,a as te,aa as fe,af as be,o as ye,M as he,N as Se,E as ae,p as we}from"./libs-Dj0SilfQ.js";import{c as ke,d as ve,e as Ie}from"./data-D9kz8a5r.js";import{v as re,S as Q,T as W,e as J,aa as ze,c as pe,E as Te,N as Le,a7 as Pe,F as xe,a2 as Ce,j as Ne,D as He,b as $e,L as Ae,f as Fe,au as De,av as Ke,Q as Be,aw as Ue,ap as Ve,a1 as je,C as Ee}from"./arcoDesign-R_OFWu-B.js";import{I as Re}from"./index-B1LheQGp.js";import{I as Ge}from"./index-DESYekPG.js";import"./uuid-BMzgKRou.js";const Me=q({__name:"accessHistoryTable",props:{ip:{}},setup(H){const{t:d,d:l}=O(),z=E(),{data:n,total:F,current:D,loading:w,pageSize:K,changeCurrent:T,changePageSize:L,run:$}=oe(ke,{defaultParams:[{ip:H.ip,page:1,pageSize:10}],pagination:{currentKey:"page",pageSizeKey:"pageSize",totalKey:"data.total"},cacheKey:i=>`${z.endpoint}-ipAccessHistory-${i?.[0].ip}-${i?.[0].page||1}-${i?.[0].pageSize||10}`}),b=[{title:()=>d("page.torrentList.accessHistory.column.downloader"),slotName:"downloader"},{title:"Peer ID",slotName:"peerId"},{title:()=>d("page.torrentList.accessHistory.column.traffic"),slotName:"traffic",width:120},{titleSlotName:"offsetTitle",slotName:"offset",width:120},{title:()=>d("page.dashboard.peerList.column.flag"),slotName:"flags",width:120},{title:()=>d("page.torrentList.accessHistory.column.timeseen"),slotName:"time",width:260},{title:()=>d("page.ipList.accessHistory.column.torrent"),dataIndex:"torrent.name",ellipsis:!0,tooltip:!0}];j(()=>H.ip,i=>{i&&$({ip:i,page:1,pageSize:10})},{immediate:!0});const k=i=>i.split(" ").map(y=>y+" - "+d("page.dashboard.peerList.column.flags."+y.trim()));return(i,y)=>{const P=pe,x=J,v=R,m=W,h=G,f=Q,_=ze,B=re,C=Te;return e(n)?.data.results||e(w)?(r(),p(B,{key:0,stripe:!0,columns:b,data:e(n)?.data.results,loading:e(w),pagination:{total:e(F),current:e(D),pageSize:e(K),showPageSize:!0,baseSize:4,bufferSize:1},"column-resizable":"",size:"medium",bordered:!1,class:"banlog-table",onPageChange:e(T),onPageSizeChange:e(L)},{downloader:t(({record:c})=>[a(P,{color:e(ne)(c.downloader.id)},{default:t(()=>[o(s(c.downloader.name),1)]),_:2},1032,["color"])]),peerId:t(({record:c})=>[N("p",null,[o(s(c.peerId?c.peerId:e(d)("page.banlist.banlist.listItem.empty"))+" ",1),a(x,{content:c.clientName?c.clientName:e(d)("page.banlist.banlist.listItem.empty")},{default:t(()=>[a(e(U))]),_:1},8,["content"])])]),traffic:t(({record:c})=>[a(f,{fill:"",direction:"vertical"},{default:t(()=>[a(m,null,{default:t(()=>[a(v,{class:"green"}),o(" "+s(e(I)(c.uploaded)),1)]),_:2},1024),a(m,null,{default:t(()=>[a(h,{class:"red"}),o(" "+s(e(I)(c.downloaded)),1)]),_:2},1024)]),_:2},1024)]),offset:t(({record:c})=>[a(f,{fill:"",direction:"vertical"},{default:t(()=>[a(m,null,{default:t(()=>[a(v,{class:"green"}),o(" "+s(e(I)(c.uploadedOffset)),1)]),_:2},1024),a(m,null,{default:t(()=>[a(h,{class:"red"}),o(" "+s(e(I)(c.downloadedOffset)),1)]),_:2},1024)]),_:2},1024)]),offsetTitle:t(()=>[a(f,{size:"mini"},{default:t(()=>[o(s(e(d)("page.torrentList.accessHistory.column.offset"))+" ",1),a(_,{content:e(d)("page.torrentList.accessHistory.column.offsetDescription")},{default:t(()=>[a(e(U))]),_:1},8,["content"])]),_:1})]),flags:t(({record:c})=>[N("p",null,[o(s(c.lastFlags)+" ",1),c.lastFlags?(r(),p(x,{key:0},{content:t(()=>[(r(!0),V(se,null,le(k(c.lastFlags),A=>(r(),V("p",{key:A},s(A),1))),128))]),default:t(()=>[a(e(U))]),_:2},1024)):g("",!0)])]),time:t(({record:c})=>[a(f,{fill:"",direction:"vertical"},{default:t(()=>[a(m,null,{default:t(()=>[o(s(e(d)("page.torrentList.accessHistory.column.timeseen.first"))+": "+s(e(l)(c.firstTimeSeen,"long")),1)]),_:2},1024),a(m,null,{default:t(()=>[o(s(e(d)("page.torrentList.accessHistory.column.timeseen.last"))+": "+s(e(l)(c.lastTimeSeen,"long")),1)]),_:2},1024)]),_:2},1024)]),_:1},8,["data","loading","pagination","onPageChange","onPageSizeChange"])):(r(),p(C,{key:1,style:{height:"20vh","align-items":"center",display:"flex","justify-content":"center","flex-direction":"column"}},{default:t(()=>[o(s(e(d)("page.torrentList.accessHistory.empty")),1)]),_:1}))}}}),qe=M(Me,[["__scopeId","data-v-daa948c1"]]),Oe=q({__name:"banHistoryTable",props:{ip:{}},setup(H){const d=E(),{t:l,d:z}=O(),{data:n,total:F,current:D,loading:w,pageSize:K,changeCurrent:T,changePageSize:L,refresh:$,run:b}=oe(ve,{defaultParams:[{ip:H.ip,page:1,pageSize:10}],pagination:{currentKey:"page",pageSizeKey:"pageSize",totalKey:"data.total"},cacheKey:y=>`${d.endpoint}-banlogs-${y?.[0].page||1}-${y?.[0].pageSize||10}`});j(()=>d.endpoint,$),j(()=>H.ip,y=>{y&&b({ip:y,page:1,pageSize:10})},{immediate:!0});const k=[{title:()=>l("page.banlog.banlogTable.column.banTime")+"/"+l("page.banlog.banlogTable.column.unbanTime"),slotName:"banAt",width:220},{title:()=>l("page.banlog.banlogTable.column.peerPort"),dataIndex:"peerPort",width:80},{title:()=>l("page.banlog.banlogTable.column.peerId"),slotName:"peerId",width:120},{title:()=>l("page.banlog.banlogTable.column.trafficSnapshot"),slotName:"peerStatus",width:150},{title:()=>l("page.banlog.banlogTable.column.torrentName"),dataIndex:"torrentName",ellipsis:!0,tooltip:!0},{title:()=>l("page.banlog.banlogTable.column.torrentSize"),slotName:"torrentSize",width:120},{title:()=>l("page.banlog.banlogTable.column.description"),dataIndex:"description",ellipsis:!0,tooltip:!0}],i=ie(()=>n.value?.data.results);return(y,P)=>{const x=Re,v=W,m=Pe,h=Q,f=R,_=G,B=Le,C=J,c=U,A=re;return r(),p(A,{stripe:!0,columns:k,data:i.value,loading:e(w),pagination:{total:e(F),current:e(D),pageSize:e(K),showPageSize:!0,baseSize:4,bufferSize:1},bordered:!1,"column-resizable":"",size:"medium",class:"banlog-table",onPageChange:e(T),onPageSizeChange:e(L)},{banAt:t(({record:u})=>[a(h,{fill:"",direction:"vertical"},{default:t(()=>[a(v,null,{default:t(()=>[a(x),o(" "+s(e(z)(u.banAt,"long")),1)]),_:2},1024),a(v,null,{default:t(()=>[a(m),o(" "+s(u.unbanAt?e(z)(u.unbanAt,"long"):e(l)("page.banlog.banlogTable.notUnbanned")),1)]),_:2},1024)]),_:2},1024)]),peerStatus:t(({record:u})=>[a(h,{fill:"",style:{"justify-content":"space-between"}},{default:t(()=>[a(h,{fill:"",direction:"vertical"},{default:t(()=>[a(v,null,{default:t(()=>[a(f,{class:"green"}),o(" "+s(e(I)(u.peerUploaded)),1)]),_:2},1024),a(v,null,{default:t(()=>[a(_,{class:"red"}),o(" "+s(e(I)(u.peerDownloaded)),1)]),_:2},1024)]),_:2},1024),a(C,{content:(u.peerProgress*100).toFixed(2)+"%"},{default:t(()=>[a(B,{percent:u.peerProgress,size:"mini"},null,8,["percent"])]),_:2},1032,["content"])]),_:2},1024)]),peerId:t(({record:u})=>[N("p",null,[o(s(u.peerId?u.peerId:e(l)("page.banlist.banlist.listItem.empty"))+" ",1),a(C,{content:u.peerClientName?u.peerClientName:e(l)("page.banlist.banlist.listItem.empty")},{default:t(()=>[a(c)]),_:1},8,["content"])])]),torrentSize:t(({record:u})=>[a(C,{content:`Hash: ${u.torrentInfoHash}`},{default:t(()=>[N("p",null,s(e(I)(u.torrentSize)),1)]),_:2},1032,["content"])]),_:1},8,["data","loading","pagination","onPageChange","onPageSizeChange"])}}}),Qe=M(Oe,[["__scopeId","data-v-c0712e1a"]]),We={class:"center searchContainer"},Je={class:"result-container center"},Xe=q({__name:"index",setup(H){const d=te(""),{t:l,d:z}=O(),{data:n,loading:F,run:D,error:w}=fe(Ie,{manual:!0}),K=E(),T=te([]),{query:L}=be(),$=k=>{if(k){if(n.value=void 0,T.value=[],k!==L.ip){const i=new URLSearchParams(window.location.search);i.set("ip",k),window.history.pushState({},"",new URL(`${window.location.origin}${window.location.pathname}?${i.toString()}`))}D(k)}};ye(()=>{L.ip&&(d.value=L.ip,$(d.value))});const b=ie(()=>K.plusStatus?.enabledFeatures?.includes("basic"));return(k,i)=>{const y=xe,P=W,x=Ce,v=Ne,m=pe,h=J,f=Q,_=$e,B=R,C=G,c=U,A=Ae,u=Fe,ce=He,X=Be,Y=Ue,Z=Ge,ee=Ke,de=De,ue=je,_e=Ve,ge=Ee;return r(),p(f,{direction:"vertical",fill:"",class:"center"},{default:t(()=>[a(x,{style:{"text-align":"center"}},{default:t(()=>[a(y,null,{default:t(()=>[o(s(e(l)("page.ipList.title")),1)]),_:1}),a(P,null,{default:t(()=>[o(s(e(l)("page.ipList.description")),1)]),_:1})]),_:1}),N("div",We,[a(v,{modelValue:d.value,"onUpdate:modelValue":i[0]||(i[0]=S=>d.value=S),"search-button":"",placeholder:"192.168.1.1....",class:"searchBox",loading:e(F),onSearch:$},null,8,["modelValue","loading"])]),N("div",Je,[he(a(ge,{class:"result-card",style:we({minWidth:e(n)?.data.found?"1150px":"400px"}),hoverable:""},{default:t(()=>[e(w)?(r(),p(_e,{key:1,status:"500",title:e(l)("page.ipList.error"),subtitle:e(w).message},{default:t(()=>[a(x,{style:{background:"var(--color-fill-2)",padding:"24px"}},{default:t(()=>[a(ue,null,{default:t(()=>[...i[7]||(i[7]=[o("Details:",-1)])]),_:1}),N("ul",null,[(r(!0),V(se,null,le(e(w).stack?.split(`
`),S=>(r(),V("li",{key:S},s(S),1))),128))])]),_:1})]),_:1},8,["title","subtitle"])):(r(),p(f,{key:0,direction:"vertical",fill:""},{default:t(()=>[a(ce,null,{title:t(()=>[a(f,null,{default:t(()=>[o(s(e(n)?.data.address)+" ",1),e(n)?.data.found?g("",!0):(r(),p(h,{key:0,content:e(l)("page.ipList.notfound.tips")},{default:t(()=>[a(m,null,{default:t(()=>[...i[2]||(i[2]=[o("Not found",-1)])]),_:1})]),_:1},8,["content"]))]),_:1})]),default:t(()=>[e(n)?.data.found?(r(),p(_,{key:0,label:e(l)("page.ipList.label.banCount"),span:2},{default:t(()=>[o(s(e(n)?.data.banCount),1)]),_:1},8,["label"])):g("",!0),e(n)?.data.found?(r(),p(_,{key:1,label:e(l)("page.ipList.label.torrentAccessCount"),span:2},{default:t(()=>[o(s(e(n)?.data.torrentAccessCount),1)]),_:1},8,["label"])):g("",!0),e(n)?.data.found?(r(),p(_,{key:2,label:e(l)("page.ipList.label.uploadedToPeer"),span:2},{default:t(()=>[a(P,null,{default:t(()=>[a(B,{class:"green"}),o(" "+s(e(I)(e(n)?.data.uploadedToPeer??0)),1)]),_:1})]),_:1},8,["label"])):g("",!0),e(n)?.data.found?(r(),p(_,{key:3,label:e(l)("page.ipList.label.downloadedFromPeer"),span:2},{default:t(()=>[a(P,null,{default:t(()=>[a(C,{class:"red"}),o(" "+s(e(I)(e(n)?.data.downloadedFromPeer??0)),1)]),_:1})]),_:1},8,["label"])):g("",!0),e(n)?.data.found?(r(),p(_,{key:4,label:e(l)("page.ipList.label.firstTimeSeen"),span:2},{default:t(()=>[o(s(e(z)(e(n)?.data.firstTimeSeen??0,"long")),1)]),_:1},8,["label"])):g("",!0),e(n)?.data.found?(r(),p(_,{key:5,label:e(l)("page.ipList.label.lastTimeSeen"),span:2},{default:t(()=>[o(s(e(z)(e(n)?.data.lastTimeSeen??0,"long")),1)]),_:1},8,["label"])):g("",!0),e(n)?.data.geo?.country?.iso||e(n)?.data.geo?.city?.name?(r(),p(_,{key:6,label:e(l)("page.banlist.banlist.listItem.geo"),span:2},{default:t(()=>[e(n).data.geo?.country?.iso?(r(),p(me,{key:0,iso:e(n).data.geo?.country?.iso??""},null,8,["iso"])):g("",!0),o(" "+s(`${e(n).data.geo?.country?.name??""} ${e(n).data.geo?.city?.name??""}`),1)]),_:1},8,["label"])):g("",!0),e(n)?.data.geo?.network?.isp?(r(),p(_,{key:7,label:e(l)("page.banlist.banlist.listItem.network.isp"),span:1},{default:t(()=>[o(s(e(n).data.geo?.network?.isp),1)]),_:1},8,["label"])):g("",!0),e(n)?.data.geo?.network?.netType?(r(),p(_,{key:8,label:e(l)("page.banlist.banlist.listItem.network.netType"),span:2},{default:t(()=>[o(s(e(n).data.geo?.network?.netType),1)]),_:1},8,["label"])):g("",!0),e(n)?.data.geo?.as?(r(),p(_,{key:9,label:e(l)("page.banlist.banlist.listItem.asn"),span:2},{default:t(()=>[a(f,null,{default:t(()=>[a(P,null,{default:t(()=>[o(s(e(n).data.geo?.as?.organization),1)]),_:1}),a(m,{color:e(ne)((e(n).data.geo?.as?.number??0).toString())},{default:t(()=>[o(s(e(n).data.geo?.as?.number),1)]),_:1},8,["color"]),a(h,{content:e(l)("page.banlist.banlist.listItem.asn.subnet")+e(n).data.geo?.as?.network?.ipAddress+"/"+e(n).data.geo?.as?.network?.prefixLength},{default:t(()=>[a(A,{href:`https://2ip.io/analytics/asn-list/?asnId=${e(n).data.geo?.as?.number}`,hoverable:!1},{default:t(()=>[a(c)]),_:1},8,["href"])]),_:1},8,["content"])]),_:1})]),_:1},8,["label"])):g("",!0),a(_,{span:8},{label:t(()=>[a(f,null,{default:t(()=>[o(s(e(l)("page.ipList.shortcut"))+" ",1),a(h,{content:e(l)("page.ipList.shortcut.tips")},{default:t(()=>[a(c)]),_:1},8,["content"])]),_:1})]),default:t(()=>[a(f,null,{default:t(()=>[a(u,{href:`https://ip.ping0.cc/ip/${d.value}`,type:"outline"},{default:t(()=>[...i[3]||(i[3]=[o(" ping0 ",-1)])]),_:1},8,["href"]),a(u,{href:`https://search.censys.io/hosts/${d.value}`,type:"outline"},{default:t(()=>[...i[4]||(i[4]=[o(" Censys ",-1)])]),_:1},8,["href"])]),_:1})]),_:1})]),_:1}),e(n)?.data.found?(r(),p(de,{key:0,"active-key":T.value,"onUpdate:activeKey":i[1]||(i[1]=S=>T.value=S),bordered:!1,"destroy-on-hide":""},{default:t(()=>[a(ee,{key:"1",header:e(l)("page.ipList.label.accessHistory"),disabled:!b.value,class:"collapse-table"},ae({"expand-icon":t(({active:S})=>[b.value&&!S?(r(),p(X,{key:0})):b.value&&S?(r(),p(Y,{key:1})):(r(),p(Z,{key:2}))]),default:t(()=>[a(qe,{ip:e(n).data.address},null,8,["ip"])]),_:2},[b.value?void 0:{name:"extra",fn:t(()=>[a(h,{content:e(l)("page.ipList.plusLock")},{default:t(()=>[a(m,{size:"small"},{default:t(()=>[...i[5]||(i[5]=[o("Plus",-1)])]),_:1})]),_:1},8,["content"])]),key:"0"}]),1032,["header","disabled"]),a(ee,{key:"2",header:e(l)("page.ipList.label.banHistory"),disabled:!b.value,class:"collapse-table"},ae({"expand-icon":t(({active:S})=>[b.value&&!S?(r(),p(X,{key:0})):b.value&&S?(r(),p(Y,{key:1})):(r(),p(Z,{key:2}))]),default:t(()=>[a(Qe,{ip:e(n).data.address},null,8,["ip"])]),_:2},[b.value?void 0:{name:"extra",fn:t(()=>[a(h,{content:e(l)("page.ipList.plusLock")},{default:t(()=>[a(m,{size:"small"},{default:t(()=>[...i[6]||(i[6]=[o("Plus",-1)])]),_:1})]),_:1},8,["content"])]),key:"0"}]),1032,["header","disabled"])]),_:1},8,["active-key"])):g("",!0)]),_:1}))]),_:1},8,["style"]),[[Se,e(n)?.data||e(w)]])])]),_:1})}}}),st=M(Xe,[["__scopeId","data-v-07ff5864"]]);export{st as default};
