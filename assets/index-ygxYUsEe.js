import{u as T}from"./index-BuJcsEKt.js";import{f as C,a7 as I,a as g,af as M,o as V,s as E,t as e,y as o,v as c,x as u,a3 as a,k as L}from"./libs-D1siNBiN.js";import{U as R,S as $,F as j,H as q,J as A,aG as H,aB as N,L as O,f as U,R as z,M as D}from"./arcoDesign-BnuLdl8F.js";import{I as G}from"./index-JkZdRzGg.js";import"./uuid-5hg4BtTT.js";const Y=C({__name:"index",setup(J){const v=T(),{t}=I(),r=g(!1),s=g({rememberPassword:!0,token:v.authToken}),n=g(),w=async({errors:d,values:l})=>{const i=d?Object.keys(d):[];if(i.length>0){n.value?.scrollToField(i[0]);return}const{token:_,rememberPassword:f}=l;if(!r.value){r.value=!0,n.value?.setFields({token:{status:"validating",message:""}});try{await v.setAuthToken(_,f),D.success({content:t("login.form.login.success"),resetOnHover:!0})}catch(m){n.value?.setFields({token:{status:"error",message:`${t("login.form.login.failed")}  ${m.message}`}})}finally{r.value=!1}}},{query:k}=M();return V(()=>{k.token&&(s.value.token=k.token,n.value?.$emit("submit",{values:s.value,errors:void 0},new Event("submit")))}),(d,l)=>{const i=j,_=G,f=H,m=A,b=N,y=O,x=U,F=q,P=$,B=z,S=R;return L(),E(S,{justify:"center"},{default:e(()=>[o(B,{xs:24,sm:20,md:16,lg:12,xl:8},{default:e(()=>[o(P,{direction:"vertical",fill:""},{default:e(()=>[o(i,{heading:3},{default:e(()=>[c(u(a(t)("login.form.title")),1)]),_:1}),o(F,{ref_key:"loginForm",ref:n,model:s.value,class:"login-form",layout:"vertical",onSubmit:w},{default:e(()=>[o(m,{field:"token",rules:[{required:!0,message:a(t)("login.form.password.errMsg")},{validator:(p,h)=>{/[a-zA-Z0-9-_]+/.test(p)?h():h(a(t)("login.form.password.errMsg"))}}],"validate-trigger":["change","input"],"hide-label":""},{default:e(()=>[o(f,{modelValue:s.value.token,"onUpdate:modelValue":l[0]||(l[0]=p=>s.value.token=p),placeholder:a(t)("login.form.password.placeholder"),"allow-clear":""},{prefix:e(()=>[o(_)]),_:1},8,["modelValue","placeholder"])]),_:1},8,["rules"]),o(m,{field:"rememberPassword",class:"login-form-password-actions"},{default:e(()=>[o(b,{checked:"rememberPassword","model-value":s.value.rememberPassword},{default:e(()=>[c(u(a(t)("login.form.rememberPassword")),1)]),_:1},8,["model-value"]),o(y,{style:{marginLeft:"auto"},href:"https://docs.pbh-btn.com/docs/network/http-server/#%E6%9B%B4%E6%94%B9-webui-token"},{default:e(()=>[c(u(a(t)("login.form.forgetPassword")),1)]),_:1})]),_:1}),o(x,{type:"primary","html-type":"submit",long:"",loading:r.value},{default:e(()=>[c(u(a(t)("login.form.login")),1)]),_:1},8,["loading"])]),_:1},8,["model"])]),_:1})]),_:1})]),_:1})}}});export{Y as default};
