import{u as B}from"./index-DgfpHrne.js";import{f as C,a8 as T,a as g,ah as I,o as M,s as E,t as e,y as o,v as c,x as d,a9 as s,k as L}from"./libs-CGCN05bf.js";import{U as H,S as R,F as U,H as $,J as j,aH as q,aC as A,L as N,f as O,R as z,M as D}from"./arcoDesign-oXuB2kqy.js";import{I as J}from"./index-4IWmHI0u.js";import"./uuid-BMzgKRou.js";const Y=C({__name:"index",setup(Z){const v=B(),{t}=T(),i=g(!1),a=g({rememberPassword:!0,token:v.authToken}),r=g(),h=async({errors:f,values:n})=>{const m=f?Object.keys(f):[];if(m.length>0){r.value?.scrollToField(m[0]);return}const{token:_,rememberPassword:p}=n;if(!i.value){i.value=!0,r.value?.setFields({token:{status:"validating",message:""}});try{await v.setAuthToken(_,p),D.success({content:t("login.form.login.success"),resetOnHover:!0})}catch(u){r.value?.setFields({token:{status:"error",message:`${t("login.form.login.failed")}  ${u.message}`}})}finally{i.value=!1}}},{query:k}=I();return M(()=>{k.token&&(a.value.token=k.token,r.value?.$emit("submit",{values:a.value,errors:void 0},new Event("submit")))}),(f,n)=>{const m=U,_=J,p=q,u=j,b=A,y=N,x=O,F=$,P=R,V=z,S=H;return L(),E(S,{justify:"center"},{default:e(()=>[o(V,{xs:24,sm:20,md:16,lg:12,xl:8},{default:e(()=>[o(P,{direction:"vertical",fill:""},{default:e(()=>[o(m,{heading:3},{default:e(()=>[c(d(s(t)("login.form.title")),1)]),_:1}),o(F,{ref_key:"loginForm",ref:r,model:a.value,class:"login-form",layout:"vertical",onSubmit:h},{default:e(()=>[o(u,{field:"token",rules:[{required:!0,message:s(t)("login.form.password.errMsg")},{validator:(l,w)=>{/[a-zA-Z0-9-_]+/.test(l)?w():w(s(t)("login.form.password.errMsg"))}}],"validate-trigger":["change","input"],"hide-label":""},{default:e(()=>[o(p,{modelValue:a.value.token,"onUpdate:modelValue":n[0]||(n[0]=l=>a.value.token=l),placeholder:s(t)("login.form.password.placeholder"),"allow-clear":""},{prefix:e(()=>[o(_)]),_:1},8,["modelValue","placeholder"])]),_:1},8,["rules"]),o(u,{field:"rememberPassword",class:"login-form-password-actions"},{default:e(()=>[o(b,{modelValue:a.value.rememberPassword,"onUpdate:modelValue":n[1]||(n[1]=l=>a.value.rememberPassword=l),checked:"rememberPassword"},{default:e(()=>[c(d(s(t)("login.form.rememberPassword")),1)]),_:1},8,["modelValue"]),o(y,{style:{marginLeft:"auto"},href:"https://docs.pbh-btn.com/docs/network/http-server/#%E6%9B%B4%E6%94%B9-webui-token"},{default:e(()=>[c(d(s(t)("login.form.forgetPassword")),1)]),_:1})]),_:1}),o(x,{type:"primary","html-type":"submit",long:"",loading:i.value},{default:e(()=>[c(d(s(t)("login.form.login")),1)]),_:1},8,["loading"])]),_:1},8,["model"])]),_:1})]),_:1})]),_:1})}}});export{Y as default};
