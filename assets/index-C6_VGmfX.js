import{u as R,b as q,c as G,I as V,f as T,h as oe,_ as M,j as me}from"./index-7ZsO_6mc.js";/* empty css              */import{f as O,a8 as Q,aa as se,w as E,s as r,a9 as e,t,y as a,v as o,x as l,m as A,u as y,j,P as le,F as ie,k as i,c as re,a as ae,ac as fe,ah as be,o as ye,M as he,N as Se,E as ne,p as Ie}from"./libs-5nLFrLpe.js";import{c as we,d as ke,e as ve}from"./data-C5YRbS7U.js";import{v as ce,S as W,T as J,e as X,ab as ze,c as de,E as xe,N as Te,a8 as Le,F as Pe,a3 as Ce,j as Ne,D as De,b as $e,L as He,f as Ae,av as Fe,aw as Ke,Q as Be,ax as Ue,aq as Ve,a2 as je,C as Ee}from"./arcoDesign-aPMGjuf5.js";import{I as Re}from"./index-C-wB2N2f.js";import{I as qe}from"./index-B50vMKiz.js";import"./uuid-BMzgKRou.js";const Ge=O({__name:"accessHistoryTable",props:{ip:{}},setup(w){const{t:d,d:s}=Q(),N=R(),{data:n,total:K,current:k,loading:v,pageSize:z,changeCurrent:D,changePageSize:$,run:L}=se(we,{defaultParams:[{ip:w.ip,page:1,pageSize:10}],pagination:{currentKey:"page",pageSizeKey:"pageSize",totalKey:"data.total"},cacheKey:m=>`${N.endpoint}-ipAccessHistory-${m?.[0].ip}-${m?.[0].page||1}-${m?.[0].pageSize||10}`}),f=[{title:()=>d("page.torrentList.accessHistory.column.downloader"),slotName:"downloader",dataIndex:"downloader",sortable:{sortDirections:["ascend","descend"],sorter:!0}},{title:"Peer ID",slotName:"peerId",dataIndex:"peerId",sortable:{sortDirections:["ascend","descend"],sorter:!0}},{title:()=>d("page.torrentList.accessHistory.column.traffic"),slotName:"traffic",dataIndex:"uploaded",sortable:{sortDirections:["ascend","descend"],sorter:!0},width:120},{titleSlotName:"offsetTitle",slotName:"offset"},{title:()=>d("page.dashboard.peerList.column.flag"),slotName:"flags",dataIndex:"lastFlags",sortable:{sortDirections:["ascend","descend"],sorter:!0},width:120},{title:()=>d("page.torrentList.accessHistory.column.timeseen"),slotName:"time",dataIndex:"firstTimeSeen",sortable:{sortDirections:["ascend","descend"],sorter:!0},width:260},{title:()=>d("page.ipList.accessHistory.column.torrent"),dataIndex:"torrent.name",sortable:{sortDirections:["ascend","descend"],sorter:!0},ellipsis:!0,tooltip:!0}];E(()=>w.ip,m=>{m&&L({ip:m,page:1,pageSize:10})},{immediate:!0});const x=m=>m.split(" ").map(u=>u+" - "+d("page.dashboard.peerList.column.flags."+u.trim())),p=(m,u)=>{L(u?{ip:w.ip,page:k.value,pageSize:z.value,sorter:`${m}|${u}`}:{ip:w.ip,page:k.value,pageSize:z.value})};return(m,u)=>{const P=de,F=X,S=q,b=J,h=G,_=W,B=ze,U=ce,C=xe;return e(n)?.data.results||e(v)?(i(),r(U,{key:0,stripe:!0,columns:f,data:e(n)?.data.results,loading:e(v),pagination:{total:e(K),current:e(k),pageSize:e(z),showPageSize:!0,baseSize:4,bufferSize:1},"column-resizable":"",size:"medium",bordered:!1,class:"banlog-table",onSorterChange:p,onPageChange:e(D),onPageSizeChange:e($)},{downloader:t(({record:c})=>[a(P,{color:e(oe)(c.downloader.id)},{default:t(()=>[o(l(c.downloader.name),1)]),_:2},1032,["color"])]),peerId:t(({record:c})=>[A("p",null,[o(l(c.peerId?c.peerId:e(d)("page.banlist.banlist.listItem.empty"))+" ",1),a(F,{content:c.clientName?c.clientName:e(d)("page.banlist.banlist.listItem.empty")},{default:t(()=>[a(e(V))]),_:1},8,["content"])])]),traffic:t(({record:c})=>[a(_,{fill:"",direction:"vertical"},{default:t(()=>[a(b,null,{default:t(()=>[a(S,{class:"green"}),o(" "+l(e(T)(c.uploaded)),1)]),_:2},1024),a(b,null,{default:t(()=>[a(h,{class:"red"}),o(" "+l(e(T)(c.downloaded)),1)]),_:2},1024)]),_:2},1024)]),offset:t(({record:c})=>[a(_,{fill:"",direction:"vertical"},{default:t(()=>[a(b,null,{default:t(()=>[a(S,{class:"green"}),o(" "+l(e(T)(c.uploadedOffset)),1)]),_:2},1024),a(b,null,{default:t(()=>[a(h,{class:"red"}),o(" "+l(e(T)(c.downloadedOffset)),1)]),_:2},1024)]),_:2},1024)]),offsetTitle:t(()=>[a(_,{size:"mini"},{default:t(()=>[o(l(e(d)("page.torrentList.accessHistory.column.offset"))+" ",1),a(B,{content:e(d)("page.torrentList.accessHistory.column.offsetDescription")},{default:t(()=>[a(e(V))]),_:1},8,["content"])]),_:1})]),flags:t(({record:c})=>[A("p",null,[o(l(c.lastFlags)+" ",1),c.lastFlags?(i(),r(F,{key:0},{content:t(()=>[(i(!0),j(ie,null,le(x(c.lastFlags),H=>(i(),j("p",{key:H},l(H),1))),128))]),default:t(()=>[a(e(V))]),_:2},1024)):y("",!0)])]),time:t(({record:c})=>[a(_,{fill:"",direction:"vertical"},{default:t(()=>[a(b,null,{default:t(()=>[o(l(e(d)("page.torrentList.accessHistory.column.timeseen.first"))+": "+l(e(s)(c.firstTimeSeen,"long")),1)]),_:2},1024),a(b,null,{default:t(()=>[o(l(e(d)("page.torrentList.accessHistory.column.timeseen.last"))+": "+l(e(s)(c.lastTimeSeen,"long")),1)]),_:2},1024)]),_:2},1024)]),_:1},8,["data","loading","pagination","onPageChange","onPageSizeChange"])):(i(),r(C,{key:1,style:{height:"20vh","align-items":"center",display:"flex","justify-content":"center","flex-direction":"column"}},{default:t(()=>[o(l(e(d)("page.torrentList.accessHistory.empty")),1)]),_:1}))}}}),Me=M(Ge,[["__scopeId","data-v-26ddcad2"]]),Oe=O({__name:"banHistoryTable",props:{ip:{}},setup(w){const d=R(),{t:s,d:N}=Q(),{data:n,total:K,current:k,loading:v,pageSize:z,changeCurrent:D,changePageSize:$,refresh:L,run:f}=se(ke,{defaultParams:[{ip:w.ip,page:1,pageSize:10}],pagination:{currentKey:"page",pageSizeKey:"pageSize",totalKey:"data.total"},cacheKey:u=>`${d.endpoint}-banlogs-${u?.[0].page||1}-${u?.[0].pageSize||10}`});E(()=>d.endpoint,L),E(()=>w.ip,u=>{u&&f({ip:u,page:1,pageSize:10})},{immediate:!0});const x=[{title:()=>s("page.banlog.banlogTable.column.banTime")+"/"+s("page.banlog.banlogTable.column.unbanTime"),slotName:"banAt",dataIndex:"banAt",sortable:{sortDirections:["ascend","descend"],sorter:!0},width:220},{title:()=>s("page.banlog.banlogTable.column.peerPort"),dataIndex:"peerPort",sortable:{sortDirections:["ascend","descend"],sorter:!0},width:90},{title:()=>s("page.banlog.banlogTable.column.peerId"),slotName:"peerId",dataIndex:"peerId",sortable:{sortDirections:["ascend","descend"],sorter:!0},width:120},{title:()=>s("page.banlog.banlogTable.column.trafficSnapshot"),slotName:"peerStatus",dataIndex:"peerUploaded",sortable:{sortDirections:["ascend","descend"],sorter:!0},width:150},{title:()=>s("page.banlog.banlogTable.column.torrentName"),dataIndex:"torrentName",sortable:{sortDirections:["ascend","descend"],sorter:!0},ellipsis:!0,tooltip:!0},{title:()=>s("page.banlog.banlogTable.column.torrentSize"),slotName:"torrentSize",dataIndex:"torrentSize",sortable:{sortDirections:["ascend","descend"],sorter:!0},width:120},{title:()=>s("page.banlog.banlogTable.column.description"),dataIndex:"description",ellipsis:!0,tooltip:!0}],p=re(()=>n.value?.data.results),m=(u,P)=>{f(P?{ip:w.ip,page:k.value,pageSize:z.value,sorter:`${u}|${P}`}:{ip:w.ip,page:k.value,pageSize:z.value})};return(u,P)=>{const F=Re,S=J,b=Le,h=W,_=q,B=G,U=Te,C=X,c=V,H=ce;return i(),r(H,{stripe:!0,columns:x,data:p.value,loading:e(v),pagination:{total:e(K),current:e(k),pageSize:e(z),showPageSize:!0,baseSize:4,bufferSize:1},bordered:!1,"column-resizable":"",size:"medium",class:"banlog-table",onSorterChange:m,onPageChange:e(D),onPageSizeChange:e($)},{banAt:t(({record:g})=>[a(h,{fill:"",direction:"vertical"},{default:t(()=>[a(S,null,{default:t(()=>[a(F),o(" "+l(e(N)(g.banAt,"long")),1)]),_:2},1024),a(S,null,{default:t(()=>[a(b),o(" "+l(g.unbanAt?e(N)(g.unbanAt,"long"):e(s)("page.banlog.banlogTable.notUnbanned")),1)]),_:2},1024)]),_:2},1024)]),peerStatus:t(({record:g})=>[a(h,{fill:"",style:{"justify-content":"space-between"}},{default:t(()=>[a(h,{fill:"",direction:"vertical"},{default:t(()=>[a(S,null,{default:t(()=>[a(_,{class:"green"}),o(" "+l(e(T)(g.peerUploaded)),1)]),_:2},1024),a(S,null,{default:t(()=>[a(B,{class:"red"}),o(" "+l(e(T)(g.peerDownloaded)),1)]),_:2},1024)]),_:2},1024),a(C,{content:(g.peerProgress*100).toFixed(2)+"%"},{default:t(()=>[a(U,{percent:g.peerProgress,size:"mini"},null,8,["percent"])]),_:2},1032,["content"])]),_:2},1024)]),peerId:t(({record:g})=>[A("p",null,[o(l(g.peerId?g.peerId:e(s)("page.banlist.banlist.listItem.empty"))+" ",1),a(C,{content:g.peerClientName?g.peerClientName:e(s)("page.banlist.banlist.listItem.empty")},{default:t(()=>[a(c)]),_:1},8,["content"])])]),torrentSize:t(({record:g})=>[a(C,{content:`Hash: ${g.torrentInfoHash}`},{default:t(()=>[A("p",null,l(e(T)(g.torrentSize)),1)]),_:2},1032,["content"])]),_:1},8,["data","loading","pagination","onPageChange","onPageSizeChange"])}}}),Qe=M(Oe,[["__scopeId","data-v-2af8f707"]]),We={class:"center searchContainer"},Je={class:"result-container center"},Xe=O({__name:"index",setup(w){const d=ae(""),{t:s,d:N}=Q(),{data:n,loading:K,run:k,error:v}=fe(ve,{manual:!0}),z=R(),D=ae([]),{query:$}=be(),L=x=>{if(x){if(n.value=void 0,D.value=[],x!==$.ip){const p=new URLSearchParams(window.location.search);p.set("ip",x),window.history.pushState({},"",new URL(`${window.location.origin}${window.location.pathname}?${p.toString()}`))}k(x)}};ye(()=>{$.ip&&(d.value=$.ip,L(d.value))});const f=re(()=>z.plusStatus?.enabledFeatures?.includes("basic"));return(x,p)=>{const m=Pe,u=J,P=Ce,F=Ne,S=de,b=X,h=W,_=$e,B=q,U=G,C=V,c=He,H=Ae,g=De,Y=Be,Z=Ue,ee=qe,te=Ke,pe=Fe,ue=je,_e=Ve,ge=Ee;return i(),r(h,{direction:"vertical",fill:"",class:"center"},{default:t(()=>[a(P,{style:{"text-align":"center"}},{default:t(()=>[a(m,null,{default:t(()=>[o(l(e(s)("page.ipList.title")),1)]),_:1}),a(u,null,{default:t(()=>[o(l(e(s)("page.ipList.description")),1)]),_:1})]),_:1}),A("div",We,[a(F,{modelValue:d.value,"onUpdate:modelValue":p[0]||(p[0]=I=>d.value=I),"search-button":"",placeholder:"192.168.1.1....",class:"searchBox",loading:e(K),onSearch:L},null,8,["modelValue","loading"])]),A("div",Je,[he(a(ge,{class:"result-card",style:Ie({minWidth:e(n)?.data.found?"1150px":"400px"}),hoverable:""},{default:t(()=>[e(v)?(i(),r(_e,{key:1,status:"500",title:e(s)("page.ipList.error"),subtitle:e(v).message},{default:t(()=>[a(P,{style:{background:"var(--color-fill-2)",padding:"24px"}},{default:t(()=>[a(ue,null,{default:t(()=>[...p[7]||(p[7]=[o("Details:",-1)])]),_:1}),A("ul",null,[(i(!0),j(ie,null,le(e(v).stack?.split(`
`),I=>(i(),j("li",{key:I},l(I),1))),128))])]),_:1})]),_:1},8,["title","subtitle"])):(i(),r(h,{key:0,direction:"vertical",fill:""},{default:t(()=>[a(g,null,{title:t(()=>[a(h,null,{default:t(()=>[o(l(e(n)?.data.address)+" ",1),e(n)?.data.found?y("",!0):(i(),r(b,{key:0,content:e(s)("page.ipList.notfound.tips")},{default:t(()=>[a(S,null,{default:t(()=>[...p[2]||(p[2]=[o("Not found",-1)])]),_:1})]),_:1},8,["content"]))]),_:1})]),default:t(()=>[e(n)?.data.found?(i(),r(_,{key:0,label:e(s)("page.ipList.label.banCount"),span:2},{default:t(()=>[o(l(e(n)?.data.banCount),1)]),_:1},8,["label"])):y("",!0),e(n)?.data.found?(i(),r(_,{key:1,label:e(s)("page.ipList.label.torrentAccessCount"),span:2},{default:t(()=>[o(l(e(n)?.data.torrentAccessCount),1)]),_:1},8,["label"])):y("",!0),e(n)?.data.found?(i(),r(_,{key:2,label:e(s)("page.ipList.label.uploadedToPeer"),span:2},{default:t(()=>[a(u,null,{default:t(()=>[a(B,{class:"green"}),o(" "+l(e(T)(e(n)?.data.uploadedToPeer??0)),1)]),_:1})]),_:1},8,["label"])):y("",!0),e(n)?.data.found?(i(),r(_,{key:3,label:e(s)("page.ipList.label.downloadedFromPeer"),span:2},{default:t(()=>[a(u,null,{default:t(()=>[a(U,{class:"red"}),o(" "+l(e(T)(e(n)?.data.downloadedFromPeer??0)),1)]),_:1})]),_:1},8,["label"])):y("",!0),e(n)?.data.found?(i(),r(_,{key:4,label:e(s)("page.ipList.label.firstTimeSeen"),span:2},{default:t(()=>[o(l(e(N)(e(n)?.data.firstTimeSeen??0,"long")),1)]),_:1},8,["label"])):y("",!0),e(n)?.data.found?(i(),r(_,{key:5,label:e(s)("page.ipList.label.lastTimeSeen"),span:2},{default:t(()=>[o(l(e(N)(e(n)?.data.lastTimeSeen??0,"long")),1)]),_:1},8,["label"])):y("",!0),e(n)?.data.geo?.country?.iso||e(n)?.data.geo?.city?.name?(i(),r(_,{key:6,label:e(s)("page.banlist.banlist.listItem.geo"),span:2},{default:t(()=>[e(n).data.geo?.country?.iso?(i(),r(me,{key:0,iso:e(n).data.geo?.country?.iso??""},null,8,["iso"])):y("",!0),o(" "+l(`${e(n).data.geo?.country?.name??""} ${e(n).data.geo?.city?.name??""}`),1)]),_:1},8,["label"])):y("",!0),e(n)?.data.geo?.network?.isp?(i(),r(_,{key:7,label:e(s)("page.banlist.banlist.listItem.network.isp"),span:1},{default:t(()=>[o(l(e(n).data.geo?.network?.isp),1)]),_:1},8,["label"])):y("",!0),e(n)?.data.geo?.network?.netType?(i(),r(_,{key:8,label:e(s)("page.banlist.banlist.listItem.network.netType"),span:2},{default:t(()=>[o(l(e(n).data.geo?.network?.netType),1)]),_:1},8,["label"])):y("",!0),e(n)?.data.geo?.as?(i(),r(_,{key:9,label:e(s)("page.banlist.banlist.listItem.asn"),span:2},{default:t(()=>[a(h,null,{default:t(()=>[a(u,null,{default:t(()=>[o(l(e(n).data.geo?.as?.organization),1)]),_:1}),a(S,{color:e(oe)((e(n).data.geo?.as?.number??0).toString())},{default:t(()=>[o(l(e(n).data.geo?.as?.number),1)]),_:1},8,["color"]),a(b,{content:e(s)("page.banlist.banlist.listItem.asn.subnet")+e(n).data.geo?.as?.network?.ipAddress+"/"+e(n).data.geo?.as?.network?.prefixLength},{default:t(()=>[a(c,{href:`https://2ip.io/analytics/asn-list/?asnId=${e(n).data.geo?.as?.number}`,hoverable:!1},{default:t(()=>[a(C)]),_:1},8,["href"])]),_:1},8,["content"])]),_:1})]),_:1},8,["label"])):y("",!0),a(_,{span:8},{label:t(()=>[a(h,null,{default:t(()=>[o(l(e(s)("page.ipList.shortcut"))+" ",1),a(b,{content:e(s)("page.ipList.shortcut.tips")},{default:t(()=>[a(C)]),_:1},8,["content"])]),_:1})]),default:t(()=>[a(h,null,{default:t(()=>[a(H,{href:`https://ip.ping0.cc/ip/${d.value}`,type:"outline"},{default:t(()=>[...p[3]||(p[3]=[o(" ping0 ",-1)])]),_:1},8,["href"]),a(H,{href:`https://search.censys.io/hosts/${d.value}`,type:"outline"},{default:t(()=>[...p[4]||(p[4]=[o(" Censys ",-1)])]),_:1},8,["href"])]),_:1})]),_:1})]),_:1}),e(n)?.data.found?(i(),r(pe,{key:0,"active-key":D.value,"onUpdate:activeKey":p[1]||(p[1]=I=>D.value=I),bordered:!1,"destroy-on-hide":""},{default:t(()=>[a(te,{key:"1",header:e(s)("page.ipList.label.accessHistory"),disabled:!f.value,class:"collapse-table"},ne({"expand-icon":t(({active:I})=>[f.value&&!I?(i(),r(Y,{key:0})):f.value&&I?(i(),r(Z,{key:1})):(i(),r(ee,{key:2}))]),default:t(()=>[a(Me,{ip:e(n).data.address},null,8,["ip"])]),_:2},[f.value?void 0:{name:"extra",fn:t(()=>[a(b,{content:e(s)("page.ipList.plusLock")},{default:t(()=>[a(S,{size:"small"},{default:t(()=>[...p[5]||(p[5]=[o("Plus",-1)])]),_:1})]),_:1},8,["content"])]),key:"0"}]),1032,["header","disabled"]),a(te,{key:"2",header:e(s)("page.ipList.label.banHistory"),disabled:!f.value,class:"collapse-table"},ne({"expand-icon":t(({active:I})=>[f.value&&!I?(i(),r(Y,{key:0})):f.value&&I?(i(),r(Z,{key:1})):(i(),r(ee,{key:2}))]),default:t(()=>[a(Qe,{ip:e(n).data.address},null,8,["ip"])]),_:2},[f.value?void 0:{name:"extra",fn:t(()=>[a(b,{content:e(s)("page.ipList.plusLock")},{default:t(()=>[a(S,{size:"small"},{default:t(()=>[...p[6]||(p[6]=[o("Plus",-1)])]),_:1})]),_:1},8,["content"])]),key:"0"}]),1032,["header","disabled"])]),_:1},8,["active-key"])):y("",!0)]),_:1}))]),_:1},8,["style"]),[[Se,e(n)?.data||e(v)]])])]),_:1})}}}),lt=M(Xe,[["__scopeId","data-v-07ff5864"]]);export{lt as default};
